---
module: Common

ConnectionType:
  - PostgreSQL <*> PostgreSQL Database
  - MySQL      <*> MySQL Database
  - MariaDB    <*> MariaDB Database
  - SqlServer  <*> Microsoft SQL Server
  - OracleDB   <*> Oracle Database
  - DB2        <*> IBM DB2 Database
  - MongoDB    <*> MongoDB Database
  - Elasticsearch <*> Elasticsearch Database

ConnectionPortsType:
  - PostgreSQL_5432
  - MySQL_3306
  - MariaDB_3306
  - SqlServer_1433
  - OracleDB_1521
  - DB2_50000
  - MongoDB_27017
  - Elasticsearch_9200

GroupMapping:
  - id: ?string
  - dymiumgroup: string
  - directorygroup: string
  - comments: string
  - adminaccess: bool

ConnectionRecord:
  - name: string
  - dbtype: string
  - usesconnector: bool
  - connectorname: string
  - connectorid: string
  - tunnelname: string 
  - tunnelid: string
  - address: string
  - port: int
  - dbname: string
  - useTLS: bool
  - description: string
  - username: ?string
  - password: ?string
  - id: ?string
  - credid: ?string

ConnectionsQuery:
  - status: string
  - errormessage: ?string
  - records: ?<|ConnectionRecord|>

TableQuery:
  - connectionId: string
  - schema: string
  - table: string

reference:
  - schema: string
  - table: string
  - column: string

DatascopeRecord:
  - id: ?string	
  - connection: string
  - connectionId: ?string	
  - schema: string
  - table: string
  - typ: string
  - position: int
  - reference: ?reference
  - action: string
  - col: string
  - semantics: string
  - dflt: ?string
  - isnullable: bool
  - possibleActions: <|string|>

DatascopeIdName:
  - name: string
  - id: string	
  - created: string
  - modified: string

DatascopeId:
  - id: string

DatascopeTable:
  - connection: string
  - datascope: string
  - schema: string
  - table: string

DatascopeTables:
  - status: string
  - errormessage:   string  
  - tables: <|DatascopeTable|>

RequestById:
  - id: string

Datascope:
  - name: string
  - id:  ?string		
  - groupsconfigured: bool
  - records: <|DatascopeRecord|>

OperationStatus:
  - status: string
  - errormessage:   string

ConnectionResponse:
  - status: string
  - errormessage:   string
  - data: <|ConnectionRecord|>

AuthStatus:
  - status: string
  - errormessage: string
  - token: string

GroupStatus:
  - status: string
  - errormessage: string
  - admincount: int

DatascopesStatus:
  - status: string
  - errormessage: string
  - records: <|DatascopeIdName|>

DatascopeInfoStatus:  
  - status: string
  - errormessage: string
  - record: ?Datascope

GroupMappingStatus:  
  - status: string
  - errormessage: string
  - records: <|GroupMapping|> 

GroupAssignment:
  - name: string
  - id: string	
  - groups: <|DatascopeIdName|>


DatascopeAndGroups:
  - id: string	
  - name: string
  - groupid: string	
  - groupname: string


UserDatascopes:
  - schema: string
  - username: string 
  - password: string 
  - datascopes: <|DatascopeIdName|>

Usage:
  - connections: int
  - datascopes: int
  - logins: int
  - tunnels: int  
  - blocked: int 
  - obfuscated: int 
  - redacted: int 
  - connectors: int 
  - connectortunnels: int   
  - bytesin: string
  - bytesout: string

# policy-related stuff
PIIDetectionType: 
  - comprehend <*> Amazon Comprehend
  - columnregexp <*> Regexp for Table Columns
  - contentregexp <*> Regexp for Data

PIIDetector:
  - id: ?string
  - name: string # PII name
  - method: PIIDetectionType
  - data: string 

DataHandling:
  - allow <*> Allow
  - block  <*> Block
  - obfuscate  <*> Obfuscate
  - redact <*> Redact
#  - smartredact <*> Smart Reduct

DataAction:
  - role: string  # just a name, given by the customer
  - index: ?int # order
  - handling: DataHandling

PIISuggestor:
  - actions: <|DataAction|>
  - detector: PIIDetector

DataPolicy:
  - actions: <|DataAction|>
  - piisuggestions: <|PIISuggestor|>

# GUI handling
AccessLevels:
  - levels: <|DataAction|>

SetConnectorStatus:
  - customer: string
  - key: string
  - secret: string
  - status: string
  
MachineTunnel:
  - id: ?string
  - accesskey: ?string
  - secret: ?string
  - name: string
  - username: ?string
  - password: ?string
  - groups: <|string|>

DockerDownloads:
  - meshconnector: string
  - machineclient: string

